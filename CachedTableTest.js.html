<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: CachedTableTest.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: CachedTableTest.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>function TestCachedTableWrapper(){
  TestCachedTable( "Origin", "Target", true );
}

/**
 * Test the Table Caching mechanism and report on improvement.
 * View results in the log.
 *
 * @param {string} fromSheetName - Name of worksheet to copy from.
 * @param {string} toSheetName - Name of worksheet to copy to.
 * @param {boolean} verbose - Show results in a message box if true.
 */
function TestCachedTable( fromSheetName, toSheetName, verbose )
{
  TestTable1_(fromSheetName, toSheetName, verbose);
  TestTable2_(fromSheetName, toSheetName, verbose);
}

function TestTable1_( origin, target, verbose ){

  var rowlast = 18;
  var collast = 12;
  var rowstart= 9;
  var colstart= 3;
  
  var rows = rowlast - rowstart + 1;
  var cols = collast - colstart + 1;
  
  if( verbose )
      Browser.msgBox("Testing " + rows + " by " + cols + " row by row copy.");
  else
      Logger.log("Testing " + rows + " by " + cols + " row by row copy.");

  var s = new Stopwatch();
  s.start();
  TestDataCopy_(rowstart,colstart,rowlast,collast,origin,target, false);
  var withoutCache = s.stop();

  s.start();
  TestDataCopy_(rowstart,colstart,rowlast,collast,origin,target, true);
  var withCache = s.stop();

  if( verbose )
      Browser.msgBox("Without Cache: " + withoutCache + " s\\n" + "With Cache: " + withCache 
      + " s\\n\\nReduction: " + (((withoutCache - withCache)*100)/withoutCache).toPrecision(4) + "%");
  else
      Logger.log("Without Cache: " + withoutCache + " s\\n" + "With Cache: " + withCache 
      + " s\\n\\nReduction: " + (((withoutCache - withCache)*100)/withoutCache).toPrecision(4) + "%");
}

function TestTable2_( origin, target, verbose ){

  var rowlast = 18;
  var collast = 12;
  var rowstart= 9;
  var colstart= 3;
  
  var rows = rowlast - rowstart + 1;
  var cols = collast - colstart + 1;
  
  if( verbose )
      Browser.msgBox("Testing " + rows + " by " + cols + " cell by cell copy.");
  else
      Logger.log("Testing " + rows + " by " + cols + " cell by cell copy.");
  
  var s = new Stopwatch();
  s.start();
  TestCellCopy_(rowstart,colstart,rowlast,collast,origin,target, false);
  var withoutCache = s.stop();

  s.start();
  TestCellCopy_(rowstart,colstart,rowlast,collast,origin,target, true);
  var withCache = s.stop();

  if( verbose )
      Browser.msgBox("Without Cache: " + withoutCache + " s\\n" + "With Cache: " + withCache 
      + " s\\n\\nReduction: " + (((withoutCache - withCache)*100)/withoutCache).toPrecision(4) + "%");
  else
      Logger.log("Without Cache: " + withoutCache + " s\\n" + "With Cache: " + withCache 
      + " s\\n\\nReduction: " + (((withoutCache - withCache)*100)/withoutCache).toPrecision(4) + "%");
}

function TestCellCopy_(row, col, rowlast, collast, targetSheetName, destSheetName, UseCache) {
  
  var origin = new ctTable(row,col,rowlast,collast,targetSheetName,UseCache);
  var target = new ctTable(row,col,rowlast,collast,destSheetName,UseCache);
  
  ctInit( origin );
  ctInit( target );
  
  for( var i=row; i&lt;=rowlast; i++ )
       for( var j=col; j&lt;=collast; j++ )
            ctSetValue(target,i,j,ctGetValue(origin,i,j));
         
  ctFlushAll( target );       
}

function TestDataCopy_(row, col, rowlast, collast, targetSheetName, destSheetName, UseCache) {

  var origin = new ctTable(row,col,rowlast,collast,targetSheetName,UseCache);
  var target = new ctTable(row,col,rowlast,collast,destSheetName,UseCache);
    
  ctInit( origin );
  ctInit( target );
  
  // try row by row copy
  var objs;
  var i=row;
  
  while( (objs = ctNextRow(origin)) !== null )
         ctSetRow(target,i++,objs);
  
  ctFlushAll( target );       
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ctTable.html">ctTable</a></li><li><a href="Stopwatch.html">Stopwatch</a></li><li><a href="Trigger.html">Trigger</a></li><li><a href="TriggerManager.html">TriggerManager</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ctColumns">ctColumns</a></li><li><a href="global.html#ctFlushAll">ctFlushAll</a></li><li><a href="global.html#ctGetRow">ctGetRow</a></li><li><a href="global.html#ctGetRowIndex">ctGetRowIndex</a></li><li><a href="global.html#ctGetValue">ctGetValue</a></li><li><a href="global.html#ctInit">ctInit</a></li><li><a href="global.html#ctNextRow">ctNextRow</a></li><li><a href="global.html#ctRows">ctRows</a></li><li><a href="global.html#ctSetRow">ctSetRow</a></li><li><a href="global.html#ctSetValue">ctSetValue</a></li><li><a href="global.html#onEditTest">onEditTest</a></li><li><a href="global.html#TestCachedTable">TestCachedTable</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Tue Apr 21 2020 18:23:24 GMT+0800 (Taipei Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
